CREATE TABLE accounts(
id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
client text,
amount numeric);

INSERT INTO accounts VALUES
(1, 'alice', 1000.00), (2, 'bob', 100.00), (3, 'bob', 900.00);


---Read Committed
begin;
SHOW transaction_isolation;
SHOW default_transaction_isolation;
		--No dirty reads.
			---The First transaction
			UPDATE accounts SET amount = amount - 200 WHERE id = 1;
			SELECT * FROM accounts WHERE client = 'alice';
			
			---The second transaction
			begin;
			SELECT * FROM accounts WHERE client = 'alice';
		--Non-repeatable reads. Now let the first transaction commit the changes. Then the
		--second transaction will repeat the same query:
		COMMIT;



		--Lost updates. 
		--The first transaction increases the previously registered value by $��� and commits this change:
		UPDATE accounts SET amount = 800.00 + 100 WHERE id = 1
		RETURNING amount;
		COMMIT;
		
		---The second transaction does the same:
		UPDATE accounts SET amount = 800.00 + 100 WHERE id = 1
		RETURNING amount;
		commit;
		
BEGIN;
UPDATE accounts SET amount = 200.00 WHERE id = 2;
UPDATE accounts SET amount = 800.00 WHERE id = 3;
INSERT INTO accounts VALUES
(4, 'charlie', 100.00);

SELECT * FROM accounts ORDER BY id;

COMMIT;
SELECT * FROM accounts ORDER BY id;
COMMIT;
